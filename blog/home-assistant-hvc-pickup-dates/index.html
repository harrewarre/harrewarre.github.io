<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>harre.dev | HVC Trash pickup dates in Home Assistant</title>
    <link rel="stylesheet" href="/assets/style/theme.css">
    <link rel="stylesheet" href="/assets/style/prism-okaidia.css">
  </head>
  <body>
    <main>
    <header>
      <h1>
        <a href="/">harre.dev</a>
      </h1>
    </header>
    <nav>
      <a href="/">home</a>
      <a href="/blog">blog</a>
      <a href="/about">about</a>
      <a href="/feed.xml">rss</a>
    </nav>
      
<article>
    <div>2023-08-06 </div>
    <h1>HVC Trash pickup dates in Home Assistant</h1>
<p>Maybe something you can use, maybe not, but if you are in an intersection of people who use Home Assistant and live in the Netherlands and in a region where HVC operates, this might be useful.</p>
<p>The integrations below will let you display a day counter until the next trash pickup takes place. This sensor data can also be used in other automations such as notifications or reminders.</p>
<p>The payload we want to load into Home Assistant looks like this:</p>
<p>[{&quot;afvalstroom_id&quot;:5,&quot;ophaaldatum&quot;:&quot;2023-08-08&quot;},{&quot;afvalstroom_id&quot;:3,&quot;ophaaldatum&quot;:&quot;2023-08-10&quot;},{&quot;afvalstroom_id&quot;:6,&quot;ophaaldatum&quot;:&quot;2023-08-31&quot;}]</p>
<p>Each element contains an ID and a date. The ID is the type of waste and the date is the next pickup date for that type of waste. We want to extract the date for each type of waste and then calculate the number of days until that date.</p>
<p>The <code>afvalstroom_id</code> determines which waste stream we are looking at. We don't want to depend on the order in which the streams are listed so we need to check for each ID and get the correct date for each type of waste. The IDs are as follows:</p>
<ul>
<li>3: Paper</li>
<li>5: Bio (greens)</li>
<li>6: Plastics and metal</li>
</ul>
<h2>Rest integration</h2>
<p>First, we need a <code>rest</code> integration that fetches the JSON that contains the dates we need, checks the ID and then extracts the date for each type of waste. This is the configuration I use:</p>
<pre class="language-yaml"><code class="language-yaml">  <span class="token key atrule">rest</span><span class="token punctuation">:</span>
    <span class="token key atrule">resource</span><span class="token punctuation">:</span> <span class="token string">"https://inzamelkalender.hvcgroep.nl/rest/adressen/0479200000035232/ophaaldata"</span>
    <span class="token key atrule">scan_interval</span><span class="token punctuation">:</span> <span class="token number">7200</span>
    <span class="token key atrule">sensor</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"Plastic ophaaldatum"</span>
        <span class="token key atrule">unique_id</span><span class="token punctuation">:</span> <span class="token string">"waste_plastic_next_pickup"</span>
        <span class="token key atrule">value_template</span><span class="token punctuation">:</span> <span class="token punctuation">></span><span class="token scalar string">
          {% set item = value_json | selectattr('afvalstroom_id','eq', 6) | list | first %}
          {{ item.ophaaldatum  }}</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"GFT Ophaaldatum"</span>
        <span class="token key atrule">unique_id</span><span class="token punctuation">:</span> <span class="token string">"waste_green_next_pickup"</span>
        <span class="token key atrule">value_template</span><span class="token punctuation">:</span> <span class="token punctuation">></span><span class="token scalar string">
          {% set item = value_json | selectattr('afvalstroom_id','eq', 5) | list | first %}
          {{ item.ophaaldatum  }}</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"Papier ophaaldatum"</span>
        <span class="token key atrule">unique_id</span><span class="token punctuation">:</span> <span class="token string">"waste_papier_next_pickup"</span>
        <span class="token key atrule">value_template</span><span class="token punctuation">:</span> <span class="token punctuation">></span><span class="token scalar string">
          {% set item = value_json | selectattr('afvalstroom_id','eq', 3) | list | first %}
          {{ item.ophaaldatum  }}</span></code></pre>
<p>I've set the URL to something NOT my address so you'll have to use the HVC website to figure out what your address ID is. The URL is in the format <code>https://inzamelkalender.hvcgroep.nl/rest/adressen/&lt;address ID&gt;/ophaaldata</code>. Use the developer tools in your browser to find the address ID.</p>
<p>Be mindfull of the <code>scan_interval</code> setting. This is the number of seconds between each API call. I've set it to 7200 seconds (2 hours) because the pickup dates don't change that often. You can set it to whatever you want, but there could be rate-limiting on the API side which will cause errors in the sensors.</p>
<p>You can put rest sensor in <code>configuration.yml</code> or any other spot where YAML is loaded from through the main configuration.</p>
<h2>Template sensors</h2>
<p>The above sensors expose the date of the next pickup for the three waste streams we have here in a single API call, so no unnecessary calls are made to the API.
To get day counters we can create some template sensors that work with the dates we gathered from the API:</p>
<pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">days_until_waste_plastic_pickup</span><span class="token punctuation">:</span>
  <span class="token key atrule">unique_id</span><span class="token punctuation">:</span> <span class="token string">"days_until_waste_plastic_pickup"</span>
  <span class="token key atrule">friendly_name</span><span class="token punctuation">:</span> <span class="token string">"Days until waste plastic pickup"</span>
  <span class="token key atrule">value_template</span><span class="token punctuation">:</span> <span class="token punctuation">></span><span class="token scalar string">
    {{ ((as_timestamp(states('sensor.plastic_ophaaldatum')) - as_timestamp(now())) / 86400) | round(0, "ceil") }}</span>
    
<span class="token key atrule">days_until_waste_paper_pickup</span><span class="token punctuation">:</span>
  <span class="token key atrule">unique_id</span><span class="token punctuation">:</span> <span class="token string">"days_until_waste_paper_pickup"</span>
  <span class="token key atrule">friendly_name</span><span class="token punctuation">:</span> <span class="token string">"Days until waste paper pickup"</span>
  <span class="token key atrule">value_template</span><span class="token punctuation">:</span> <span class="token punctuation">></span><span class="token scalar string">
    {{ ((as_timestamp(states('sensor.papier_ophaaldatum')) - as_timestamp(now())) / 86400) | round(0, "ceil") }}</span>
    
<span class="token key atrule">days_until_waste_green_pickup</span><span class="token punctuation">:</span>
  <span class="token key atrule">unique_id</span><span class="token punctuation">:</span> <span class="token string">"days_until_waste_green_pickup"</span>
  <span class="token key atrule">friendly_name</span><span class="token punctuation">:</span> <span class="token string">"Days until waste bio pickup"</span>
  <span class="token key atrule">value_template</span><span class="token punctuation">:</span> <span class="token punctuation">></span><span class="token scalar string">
    {{ ((as_timestamp(states('sensor.gft_ophaaldatum')) - as_timestamp(now())) / 86400) | round(0, "ceil") }}</span></code></pre>
<p>These custom sensors can go in any YAML file where you've defined <code>- platform: template</code> sensors. We take the timestamp of the pickup date and subtract the current timestamp. This gives us the number of seconds until the pickup date. We divide this by the number of seconds in a day (86400) and round up to the nearest integer. This gives us the number of days until the pickup date ðŸ˜Š</p>
<p>From here you can update your UI and include these in your dashboards and automations. Enjoy!</p>

    <div class="tags">
        
            home assistant
        
            yaml
        
    </div>
</article>

    <footer>
      <p>Â© 2025 harre.dev</p>
    </footer>
    </main>
  </body>
</html>
